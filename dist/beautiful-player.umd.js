!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).BeautifulPlayer={})}(this,function(t){"use strict";function e(t,e){var n,o,a;const i=t.querySelector("audio"),r=t.querySelector('[data-role="play"]'),s=t.querySelector('[data-role="current"]'),d=t.querySelector('[data-role="duration"]'),l=t.querySelector('[data-role="speed"]'),c=t.querySelector('[data-role="volume"]'),p=t.querySelector('[data-role="volume-range"]'),u=t.querySelector('[data-role="download"]'),f=t.querySelector(".bfp-progress"),h=t.querySelector(".bfp-wave"),m=h.getContext("2d"),v={play:(null===(n=e.icons)||void 0===n?void 0:n.play)||"►",pause:(null===(o=e.icons)||void 0===o?void 0:o.pause)||"❚❚"},y=()=>{r.textContent=i.paused?v.play:v.pause};if(r.addEventListener("click",()=>{i.paused?i.play():i.pause()}),i.addEventListener("play",y),i.addEventListener("pause",y),y(),l&&e.speeds&&e.speeds.length){let t=0;const n=()=>{l.textContent=`${e.speeds[t]}x`};l.addEventListener("click",()=>{t=(t+1)%e.speeds.length,i.playbackRate=e.speeds[t],n()}),i.playbackRate=e.speeds[0],n()}if(c&&p){const n=null!==(a=e.maxVolume)&&void 0!==a?a:1;i.volume=n,p.value=String(n);const o=()=>{var e;null===(e=t.querySelector(".volume-card"))||void 0===e||e.classList.add("active")},r=()=>{var e;null===(e=t.querySelector(".volume-card"))||void 0===e||e.classList.remove("active")};let s=!1;c.addEventListener("click",t=>{t.stopPropagation(),s=!s,s?o():r()}),p.addEventListener("input",t=>{const e=Number(t.target.value);i.volume=e,c.textContent=`${Math.round(100*e)}%`}),document.addEventListener("click",()=>{s=!1,r()})}u&&(u.href=e.src);const b=t=>`${Math.floor(t/60)}:${Math.floor(t%60).toString().padStart(2,"0")}`;let g,w,x,E;function S(){h.width=f.clientWidth,h.height=f.clientHeight}function L(t=0){S(),m.clearRect(0,0,h.width,h.height);const e=Math.floor(h.width/3),n=h.height/2;for(let o=0;o<e;o++){const e=(.3+.6*Math.random())*h.height,a=3*o,i=n-e/2,r=a/h.width<t;m.fillStyle=r?"#fff":"rgba(255,255,255,0.3)",m.fillRect(a,i,2,e)}}i.addEventListener("loadedmetadata",()=>{d.textContent=b(i.duration)}),s&&i.addEventListener("timeupdate",()=>{s.textContent=b(i.currentTime)}),S(),window.addEventListener("resize",S);let C=!0;function q(){E=requestAnimationFrame(q),w.getByteFrequencyData(x),m.clearRect(0,0,h.width,h.height);const t=Math.min(Math.floor(h.width/3),x.length),e=h.height/2,n=i.currentTime/i.duration*h.width;for(let o=0;o<t;o++){const t=x[o]/255*h.height,a=3*o,i=e-t/2,r=a+2<=n;m.fillStyle=r?"#fff":"rgba(255,255,255,0.3)",m.fillRect(a,i,2,t)}}L(),i.addEventListener("play",()=>{C=!1,function(){if(g)return;g=new(window.AudioContext||window.webkitAudioContext),w=g.createAnalyser(),w.fftSize=512,g.createMediaElementSource(i).connect(w),w.connect(g.destination),x=new Uint8Array(w.frequencyBinCount)}(),q()}),i.addEventListener("pause",()=>{cancelAnimationFrame(E)}),i.addEventListener("ended",()=>{cancelAnimationFrame(E),C=!0,L()});let A=!1;function k(t){const e=f.getBoundingClientRect(),n=Math.min(Math.max((t.clientX-e.left)/e.width,0),1);C&&L(n),i.duration&&(i.currentTime=n*i.duration)}f.addEventListener("mousedown",t=>{A=!0,k(t)}),window.addEventListener("mousemove",t=>{A&&k(t)}),window.addEventListener("mouseup",()=>A=!1),e.tooltips||t.querySelectorAll("[data-tooltip]").forEach(t=>t.removeAttribute("data-tooltip"))}var n=":host {\n  --primary: #222375;\n  --btn-size: 48px;\n  --wave-height: 36px;\n  --tooltip-bg: rgba(0, 0, 0, 0.8);\n  --tooltip-color: #fff;\n  font-family: Arial, Helvetica, sans-serif;\n  display: inline-block;\n}\n\n.bfp-container {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  gap: 1rem;\n  background: var(--primary);\n  padding: 0.75rem 1rem;\n  border-radius: 24px;\n}\n\n.bfp-button {\n  background: #ffffff;\n  border: none;\n  color: var(--primary);\n  width: var(--btn-size);\n  height: var(--btn-size);\n  border-radius: 50%;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n  transition: transform 0.2s ease;\n}\n\n.bfp-button:hover {\n  transform: scale(1.05);\n}\n\n.bfp-progress {\n  flex: 1;\n  min-width: 160px;\n  height: var(--wave-height);\n  background: rgba(255, 255, 255, 0.15);\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n}\n\n.bfp-wave {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n}\n\n/* Tooltip */\n.bfp-button[data-tooltip]::after,\n.bfp-download[data-tooltip]::after {\n  content: attr(data-tooltip);\n  position: absolute;\n  bottom: 120%;\n  left: 50%;\n  transform: translateX(-50%) translateY(10px);\n  background: var(--tooltip-bg);\n  color: var(--tooltip-color);\n  padding: 4px 6px;\n  border-radius: 4px;\n  font-size: 0.7rem;\n  white-space: nowrap;\n  opacity: 0;\n  pointer-events: none;\n  transition: opacity 0.2s, transform 0.2s;\n  z-index: 20;\n}\n\n.bfp-button[data-tooltip]:hover::after,\n.bfp-download[data-tooltip]:hover::after {\n  opacity: 1;\n  transform: translateX(-50%) translateY(0);\n}\n\n.bfp-time-total {\n  position: absolute;\n  bottom: 4px;\n  left: 8px;\n  font-size: 0.75rem;\n  color: #ffffff;\n}\n";!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}(n);const o={play:"►",pause:"❚❚",download:"⬇"};function a(t,...e){return t.map((t,n)=>`${t}${e[n]||""}`).join("")}class i extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadow=this.shadowRoot}connectedCallback(){const t=this.getAttribute("src")||"",e=this.getAttribute("speeds"),n=e?e.split(",").map(Number):[1,1.5,2];this.opts={src:t,speeds:n,autoplay:this.hasAttribute("autoplay"),primaryColor:this.getAttribute("primary-color")||void 0},this.render()}render(){const{src:t,autoplay:i}=this.opts,r={...o,...this.opts.icons},s=document.createElement("template");s.innerHTML=a`
      <style>
        ${n}
        :host {
          --primary: ${this.opts.primaryColor||"var(--primary, #222375)"};
        }
      </style>
      <div class="bfp-container">
        <audio ${i?"autoplay":""}>
          <source src="${t}">
        </audio>
        <button class="bfp-button" data-role="play">${r.play}</button>
        <div class="bfp-progress"><canvas class="bfp-wave"></canvas></div>
        <span class="bfp-time-total" data-role="duration">0:00</span>
      </div>
    `,this.shadow.innerHTML="",this.shadow.appendChild(s.content.cloneNode(!0)),this.audio=this.shadow.querySelector("audio"),e(this.shadow,this.opts)}}customElements.get("beautiful-audio")||customElements.define("beautiful-audio",i),t.AudioPlayer=i});
//# sourceMappingURL=beautiful-player.umd.js.map
